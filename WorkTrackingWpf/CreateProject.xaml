<Page x:Class="WorkTrackingWpf.CreateProject"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:WorkTrackingWpf"
      mc:Ignorable="d"
      Title="CreateProject" Height="964" Width="1673" AutomationProperties.IsOffscreenBehavior="FromClip">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="0*"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!-- Sekmeler için TabControl -->
        <TabControl AutomationProperties.IsOffscreenBehavior="Onscreen"
                    Grid.RowSpan="2">

            <TabItem Header="Proje Ekle">
                <Grid>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>

                            <!-- 🔹 SOL TARAF: Proje Bilgileri -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Margin="10">
                                <Label Content="Proje Bilgileri" FontSize="16" FontWeight="Bold" Margin="5"/>
                                <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <Grid Grid.Column="0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <Label Content="Firma Adı:" Grid.Row="0" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="CompanyComboBox" Grid.Row="0" Height="30" Width="250" Margin="10"/>

                                        <Label Content="İş Adı:" Grid.Row="1" VerticalAlignment="Center"/>
                                        <TextBox x:Name="JobNameTextBox" Grid.Row="1" Height="30" Width="250" Margin="10"/>

                                        <Label Content="Proje Başlangıç Tarihi:" Grid.Row="2" VerticalAlignment="Center"/>
                                        <DatePicker x:Name="ProjectStartDatePicker" Grid.Row="2" Height="30" Width="250" Margin="10"/>

                                        <Label Content="Proje Bitiş Tarihi:" Grid.Row="3" VerticalAlignment="Center"/>
                                        <DatePicker x:Name="ProjectEndDatePicker" Grid.Row="3" Height="30" Width="250" Margin="10"/>
                                    </Grid>

                                    <Grid Grid.Column="1">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <Label Content="İş No:" Grid.Row="0" VerticalAlignment="Center"/>
                                        <TextBox x:Name="JobNumberTextBox" Grid.Row="0" Height="30" Width="250" Margin="10"/>

                                        <Label Content="Sözleşme Türü:" Grid.Row="1" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="ContractTypeComboBox" Grid.Row="1" Height="30" Width="250" Margin="10"/>

                                        <Label Content="Sözleşme Cinsi:" Grid.Row="2" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="ContractCurrencyComboBox" Grid.Row="2" Height="30" Width="250" Margin="10"/>

                                        <Label Content="Sözleşme Miktarı:" Grid.Row="3" VerticalAlignment="Center"/>
                                        <TextBox x:Name="ContractAmountTextBox" Grid.Row="3" Height="30" Width="250" Margin="10"/>

                                        <Label Content="Birim Başına Miktar:" Grid.Row="4" VerticalAlignment="Center"/>
                                        <TextBox x:Name="UnitAmountTextBox" Grid.Row="4" Height="30" Width="250" Margin="10"/>
                                    </Grid>
                                </Grid>

                                <Button x:Name="SaveProjectButton"
                            Content="Proje Kaydet"
                            Background="#1ABC9C"
                            Foreground="White"
                            FontWeight="Bold"
                            Height="40"
                            Width="300"
                            Margin="5"
                            Click="SaveProjectButton_Click"/>
                            </StackPanel>

                            <!-- 🔹 SAĞ TARAF: Proje Görev Atama -->
                            <Grid Grid.Row="0" Grid.Column="1" Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Label Content="Proje Seç:" Grid.Row="0" VerticalAlignment="Center"/>
                                <ComboBox x:Name="TaskSelectionComboBox"
                              Grid.Row="0"
                              Height="30"
                              Width="250"
                              Margin="5"
                              DisplayMemberPath="ProjectName"
                              SelectedValuePath="ProjectId"
                              SelectionChanged="ProjectSelectionComboBox_SelectionChanged"/>

                                <Label Content="Görevler:" Grid.Row="1" VerticalAlignment="Center"/>
                                <ListBox Name="TaskSelectionListBox"
                             Grid.Row="1"
                             SelectionMode="Multiple"
                             Height="150"
                             Width="250"
                             ScrollViewer.VerticalScrollBarVisibility="Auto">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox IsChecked="{Binding IsChecked}"
                                              Content="{Binding Task.TaskName}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                                <Button x:Name="SaveJobButton"
                            Grid.Row="2"
                            Content="Görev Tanımla"
                            Background="#1ABC9C"
                            Foreground="White"
                            FontWeight="Bold"
                            Height="40"
                            Width="250"
                            Margin="5"
                            Click="SaveJobButton_Click"/>
                            </Grid>

                            <!-- 🔹 ALT KISIM: Proje Listesi (Tablo) -->
                            <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Margin="10">
                                <Label Content="Proje Listesi" FontSize="16" FontWeight="Bold" Margin="5"/>
                                <ComboBox x:Name="StatusFilterComboBox"
                              Height="40"
                              Width="300"
                              Margin="5"
                              SelectionChanged="StatusFilterComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Tümü" Tag="All" IsSelected="True"/>
                                    <ComboBoxItem Content="Aktif" Tag="Aktif"/>
                                    <ComboBoxItem Content="Pasif" Tag="Pasif"/>
                                </ComboBox>

                                <ScrollViewer VerticalScrollBarVisibility="Auto" PreviewMouseWheel="ProjectsDataGrid_PreviewMouseWheel">
                                    <DataGrid x:Name="ProjectsDataGrid"
                                  Height="350"
                                  Width="Auto"
                                  AutoGenerateColumns="False"
                                  SelectionMode="Single"
                                  SelectionUnit="FullRow"
                                  SelectedItem="{Binding SelectedProject}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Proje No" Binding="{Binding ProjectNumber}" Width="*" />
                                            <DataGridTextColumn Header="Proje Adı" Binding="{Binding ProjectName}" Width="*" />
                                            <DataGridTextColumn Header="Firma Adı" Binding="{Binding Company.CompanyName}" Width="*" />
                                            <DataGridTextColumn Header="Başlangıç Tarihi" Binding="{Binding ProjectStartTime, StringFormat={}{0:dd.MM.yyyy}}" Width="*" />
                                            <DataGridTextColumn Header="Bitiş Tarihi" Binding="{Binding ProjectEndTime, StringFormat={}{0:dd.MM.yyyy}}" Width="*" />
                                            <DataGridTextColumn Header="Sözleşme Miktarı" Binding="{Binding ContractAmount, StringFormat=N2}" />
                                            <DataGridTextColumn Header="Birim Miktar" Binding="{Binding UnitAmount, StringFormat=N2}" />
                                            <DataGridTextColumn Header="Sözleşme Cinsi" Binding="{Binding ContractCurrency}" Width="*" />
                                            <DataGridTextColumn Header="Sözleşme Türü" Binding="{Binding ContractType.ContractTypeName}" Width="*" />
                                            <DataGridTextColumn Header="Toplam Miktar" Binding="{Binding TotalAmount, StringFormat=N2}" />
                                            <DataGridTextColumn Header="Durum" Binding="{Binding ProjectStatus}" Width="*" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </ScrollViewer>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </Grid>
            </TabItem>




            <!-- İkinci Sekme: İş Tanımlama ve Sözleşme Türü -->
            <TabItem Header="İş Tanımlama ve Sözleşme Türü">
                <StackPanel Margin="10">

                    <!-- İş Tanımlama (Eskiden Proje Görev Atama da buradaydı, Artık Kaldırdık) -->
                    <GroupBox Header="İş Tanımlama" Margin="10">
                        <StackPanel Orientation="Vertical" Margin="10">
                            <Label Content="İş Adı:" />
                            <TextBox x:Name="SaveNewTaskBox"
                                     Height="40"
                                     Width="300"
                                     Margin="5" />
                            <Button x:Name="AddTaskButton"
                                    Content="İş Kaydet"
                                    Background="Green"
                                    Foreground="White"
                                    FontWeight="Bold"
                                    Height="40"
                                    Width="300"
                                    Margin="5"
                                    Click="AddTaskButton_Click" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Sözleşme Türü Tanımlama -->
                    <GroupBox Header="Sözleşme Türü Tanımlama" Margin="10">
                        <StackPanel Orientation="Vertical" Margin="10">
                            <Label Content="Sözleşme Türü Adı:" />
                            <TextBox x:Name="ContractTypeNameTextBox"
                                     Height="40"
                                     Width="300"
                                     Margin="5" />

                            <!-- Kaydet Butonu -->
                            <Button x:Name="SaveContractTypeButton"
                                    Content="Türü Kaydet"
                                    Background="#1ABC9C"
                                    Foreground="White"
                                    FontWeight="Bold"
                                    Height="40"
                                    Width="300"
                                    Margin="5"
                                    Click="SaveContractTypeButton_Click" />
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>

        </TabControl>
    </Grid>
</Page>
